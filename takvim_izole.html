<!doctype html>
<html lang="tr">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Vardiya Takvimi (İzole)</title>
    <style>
      html, body { height: 100%; margin: 0; padding: 0; }
      body { background: #f9fafb; font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif; color: #111827; }
      button { font-family: inherit; }
      .header { background-color: #1e40af; color: #fff; padding: 12px 16px; }
      .year-toolbar { background: #fff; border-bottom: 1px solid #e5e7eb; padding: 12px 16px; display:flex; justify-content:center; gap:8px; }
      .year-button { padding: 4px 12px; border-radius: 4px; font-size: 14px; font-weight: 600; border: none; cursor: pointer; }
      .year-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 12px; padding: 12px 16px; }
      .month { background: #fff; border: 2px solid #111827; }
      .month-title { text-align: center; font-weight: 800; font-size: 16px; letter-spacing: 1px; padding: 6px 0; text-transform: uppercase; }
      .dow { display: grid; grid-template-columns: repeat(7, 1fr); border-top: 1px solid #111827; border-bottom: 1px solid #111827; }
      .dow div { text-align: center; font-weight: 700; font-size: 11px; padding: 4px 0; }
      .days { display: grid; grid-template-columns: repeat(7, 1fr); }
      .cell { height: 26px; line-height: 26px; text-align: center; border-right: 1px solid #111827; border-bottom: 1px solid #111827; font-size: 12px; }
      .cell-empty { background: #fff; }
      .cell-shift { background: #fde047; /* amber-300 */ }
      .cell-today { outline: 2px solid #facc15; outline-offset: -2px; }
      .num { font-weight: 700; }
      .num-sun { color: #dc2626; }
      .legend { padding: 0 16px 16px; font-size: 14px; }
      .legend-row { display:flex; align-items:center; gap:8px; margin-top:8px; }
      .legend-swatch { width: 16px; height: 16px; border: 1px solid #111827; }
      .legend-swatch.shift { background:#fde047; }
      .legend-swatch.today { background:#fff; border:2px solid #facc15; }
      @media (max-width: 900px) {
        .year-grid { grid-template-columns: repeat(2, 1fr); }
      }
      @media (max-width: 600px) {
        .year-grid { grid-template-columns: 1fr; }
      }
    </style>
  </head>
  <body>
    <div id="app"></div>
    <script>
      // State
      let currentYear = 2025; // başlangıç yılı
      const today = new Date();

      // Data structure: { "YYYY-MM-DD": shiftNumber }
      function createShiftData() {
        const shifts = {};

        // 2025 shifts
        const shifts2025 = [
          [1, [5, 6, 7], 1],
          [2, [11, 12, 13], 1],
          [3, [17, 18, 19], 1],
          [4, [23, 24, 25], 1],
          [5, [29, 30, 31], 1],
          [6, [4, 5, 6], 2],
          [7, [10, 11, 12], 2],
          [8, [16, 17, 18], 2],
          [9, [22, 23, 24], 2],
          [10, [28, 1, 2], [2, 3]],
          [11, [6, 7, 8], 3],
          [12, [12, 13, 14], 3],
          [13, [18, 19, 20], 3],
          [14, [24, 25, 26], 3],
          [15, [30, 31, 1], [3, 4]],
          [16, [5, 6, 7], 4],
          [17, [11, 12, 13], 4],
          [18, [17, 18, 19], 4],
          [19, [23, 24, 25], 4],
          [20, [29, 30, 1], [4, 5]],
          [21, [5, 6, 7], 5],
          [22, [11, 12, 13], 5],
          [23, [17, 18, 19], 5],
          [24, [23, 24, 25], 5],
          [25, [29, 30, 31], 5],
          [26, [4, 5, 6], 6],
          [27, [10, 11, 12], 6],
          [28, [16, 17, 18], 6],
          [29, [22, 23, 24], 6],
          [30, [28, 29, 30], 6],
          [31, [4, 5, 6], 7],
          [32, [10, 11, 12], 7],
          [33, [16, 17, 18], 7],
          [34, [22, 23, 24], 7],
          [35, [28, 29, 30], 7],
          [36, [3, 4, 5], 8],
          [37, [9, 10, 11], 8],
          [38, [15, 16, 17], 8],
          [39, [21, 22, 23], 8],
          [40, [27, 28, 29], 8],
          [41, [2, 3, 4], 9],
          [42, [8, 9, 10], 9],
          [43, [14, 15, 16], 9],
          [44, [20, 21, 22], 9],
          [45, [26, 27, 28], 9],
          [46, [2, 3, 4], 10],
          [47, [8, 9, 10], 10],
          [48, [14, 15, 16], 10],
          [49, [20, 21, 22], 10],
          [50, [26, 27, 28], 10],
          [51, [1, 2, 3], 11],
          [52, [7, 8, 9], 11],
          [53, [13, 14, 15], 11],
          [54, [19, 20, 21], 11],
          [55, [25, 26, 27], 11],
          [56, [1, 2, 3], 12],
          [57, [7, 8, 9], 12],
          [58, [13, 14, 15], 12],
          [59, [19, 20, 21], 12],
          [60, [25, 26, 27], 12],
          [61, [31, 1, 2], [12, 1]],
        ];

        // 2026 shifts
        const shifts2026 = [
          [1, [6, 7, 8], 1],
          [2, [12, 13, 14], 1],
          [3, [18, 19, 20], 1],
          [4, [24, 25, 26], 1],
          [5, [30, 31, 1], [1, 2]],
          [6, [5, 6, 7], 2],
          [7, [11, 12, 13], 2],
          [8, [17, 18, 19], 2],
          [9, [23, 24, 25], 2],
          [10, [1, 2, 3], 3],
          [11, [7, 8, 9], 3],
          [12, [13, 14, 15], 3],
          [13, [19, 20, 21], 3],
          [14, [25, 26, 27], 3],
          [15, [31, 1, 2], [3, 4]],
          [16, [6, 7, 8], 4],
          [17, [12, 13, 14], 4],
          [18, [18, 19, 20], 4],
          [19, [24, 25, 26], 4],
          [20, [30, 1, 2], [4, 5]],
          [21, [6, 7, 8], 5],
          [22, [12, 13, 14], 5],
          [23, [18, 19, 20], 5],
          [24, [24, 25, 26], 5],
          [25, [30, 31, 1], [5, 6]],
          [26, [5, 6, 7], 6],
          [27, [11, 12, 13], 6],
          [28, [17, 18, 19], 6],
          [29, [23, 24, 25], 6],
          [30, [29, 30, 1], [6, 7]],
          [31, [5, 6, 7], 7],
          [32, [11, 12, 13], 7],
          [33, [17, 18, 19], 7],
          [34, [23, 24, 25], 7],
          [35, [29, 30, 31], 7],
          [36, [4, 5, 6], 8],
          [37, [10, 11, 12], 8],
          [38, [16, 17, 18], 8],
          [39, [22, 23, 24], 8],
          [40, [28, 29, 30], 8],
          [41, [3, 4, 5], 9],
          [42, [9, 10, 11], 9],
          [43, [15, 16, 17], 9],
          [44, [21, 22, 23], 9],
          [45, [27, 28, 29], 9],
          [46, [3, 4, 5], 10],
          [47, [9, 10, 11], 10],
          [48, [15, 16, 17], 10],
          [49, [21, 22, 23], 10],
          [50, [27, 28, 29], 10],
          [51, [2, 3, 4], 11],
          [52, [8, 9, 10], 11],
          [53, [14, 15, 16], 11],
          [54, [20, 21, 22], 11],
          [55, [26, 27, 28], 11],
          [56, [2, 3, 4], 12],
          [57, [8, 9, 10], 12],
          [58, [14, 15, 16], 12],
          [59, [20, 21, 22], 12],
          [60, [26, 27, 28], 12],
        ];

        // 2027 shifts - partial
        const shifts2027 = [
          [1, [4, 5, 6], 1],
          [2, [10, 11, 12], 1],
          [3, [16, 17, 18], 1],
          [4, [22, 23, 24], 1],
          [5, [28, 29, 30], 1],
          [6, [3, 4, 5], 2],
          [7, [9, 10, 11], 2],
          [8, [15, 16, 17], 2],
          [9, [21, 22, 23], 2],
          [10, [27, 28, 1], [2, 3]],
        ];

        // Helper to add shift dates
        // Not changing input data; only interpreting cross-month spans sequentially
        // so that e.g. [30,31,1] with months [3,4] maps to 30-31 (Mar) and 1 (Apr).
        const addShiftDates = (shiftNumber, days, months, year) => {
          if (!Array.isArray(days) || days.length === 0) return;

          // normalize months plan for each day
          const monthPlan = [];
          let currentYear = year;
          let prevDay = null;
          let prevMonth = null;

          if (Array.isArray(months)) {
            let monthPtr = (months[0] ?? 1) - 1; // 0-based month of first day
            for (let i = 0; i < days.length; i++) {
              const d = days[i];
              if (i > 0) {
                // Only switch month when the day-of-month rolls over (e.g., 31 -> 1)
                if (prevDay != null && d < prevDay) {
                  const nextRefIndex = Math.min(i, months.length - 1);
                  const candidate = (months[nextRefIndex] ?? (monthPtr + 2)) - 1; // fallback to next month
                  if (candidate < monthPtr) currentYear += 1; // Dec -> Jan
                  monthPtr = candidate;
                }
              }
              monthPlan.push({ y: currentYear, m: monthPtr });
              prevDay = d;
              prevMonth = monthPtr;
            }
          } else {
            const m0 = months - 1;
            for (let i = 0; i < days.length; i++) monthPlan.push({ y: currentYear, m: m0 });
          }

          // Materialize dates
          monthPlan.forEach((ym, idx) => {
            const day = days[idx];
            const date = new Date(ym.y, ym.m, day);
            if (
              date.getFullYear() === ym.y &&
              date.getMonth() === ym.m &&
              date.getDate() === day
            ) {
              const key = date.toISOString().split('T')[0];
              shifts[key] = shiftNumber;
            }
          });
        };

        // Process years
        shifts2025.forEach(([shiftNum, days, months]) => {
          addShiftDates(shiftNum, days, months, 2025);
        });
        shifts2026.forEach(([shiftNum, days, months]) => {
          addShiftDates(shiftNum, days, months, 2026);
        });
        shifts2027.forEach(([shiftNum, days, months]) => {
          addShiftDates(shiftNum, days, months, 2027);
        });

        return shifts;
      }

      const shiftData = createShiftData();

      function getShiftNumber(date) {
        const dateKey = date.toISOString().split("T")[0];
        return shiftData[dateKey] || null;
      }

      function isToday(date) {
        return date.toDateString() === today.toDateString();
      }

      function getMonthName(month) {
        const months = [
          "Ocak", "Şubat", "Mart", "Nisan", "Mayıs", "Haziran",
          "Temmuz", "Ağustos", "Eylül", "Ekim", "Kasım", "Aralık"
        ];
        return months[month];
      }

      function getDaysInMonth(year, month) {
        return new Date(year, month + 1, 0).getDate();
      }

      // 0=Monday ... 6=Sunday (for layout)
      function firstDayIndexMonday(year, month) {
        const day = new Date(year, month, 1).getDay(); // 0=Sun .. 6=Sat
        return (day + 6) % 7; // shift to Monday-first
      }

      function goToYear(year) {
        currentYear = year;
        render();
      }

      function el(tag, props = {}, children = []) {
        const node = document.createElement(tag);
        Object.entries(props).forEach(([k, v]) => {
          if (k === 'style' && v && typeof v === 'object') {
            Object.assign(node.style, v);
          } else if (k.startsWith('on') && typeof v === 'function') {
            node.addEventListener(k.substring(2).toLowerCase(), v);
          } else if (k === 'text') {
            node.textContent = v;
          } else {
            node.setAttribute(k, v);
          }
        });
        (Array.isArray(children) ? children : [children]).forEach(c => {
          if (c == null) return;
          node.appendChild(typeof c === 'string' ? document.createTextNode(c) : c);
        });
        return node;
      }

      function renderMonth(year, month) {
        const monthBox = el('div', { class: 'month' });
        monthBox.appendChild(el('div', { class: 'month-title' }, getMonthName(month).toUpperCase()));

        const dow = el('div', { class: 'dow' }, [
          'PZT', 'SA', 'ÇA', 'PE', 'CU', 'CTS', 'PAZ'
        ].map(t => el('div', {}, t)));
        monthBox.appendChild(dow);

        const daysWrap = el('div', { class: 'days' });
        const daysInMonth = getDaysInMonth(year, month);
        const firstDay = firstDayIndexMonday(year, month);
        const total = firstDay + daysInMonth;
        for (let i = 0; i < total; i++) {
          if (i < firstDay) {
            daysWrap.appendChild(el('div', { class: 'cell cell-empty' }));
          } else {
            const day = i - firstDay + 1;
            const date = new Date(year, month, day);
            const shiftNumber = getShiftNumber(date);
            const isSun = (i % 7) === 6;
            const cls = ['cell'];
            if (shiftNumber) cls.push('cell-shift');
            if (isToday(date)) cls.push('cell-today');
            const numCls = ['num'];
            if (isSun) numCls.push('num-sun');
            const dEl = el('div', { class: cls.join(' ') }, el('span', { class: numCls.join(' ') }, String(day)));
            daysWrap.appendChild(dEl);
          }
        }
        // Ensure full 6 weeks grid for consistent height
        const remainder = (42 - (firstDay + daysInMonth));
        for (let k = 0; k < remainder; k++) daysWrap.appendChild(el('div', { class: 'cell cell-empty' }));

        monthBox.appendChild(daysWrap);
        return monthBox;
      }

      function render() {
        const app = document.getElementById('app');
        app.innerHTML = '';

        const header = el('header', { class: 'header' },
          el('div', { style: { display: 'flex', alignItems: 'center', justifyContent:'center' } },
            el('h1', { style: { fontSize: '18px', fontWeight: '700' } }, 'Vardiya Takvimi - Yıllık Görünüm')
          )
        );

        const toolbar = el('div', { class: 'year-toolbar' }, [
          ...[2025, 2026, 2027].map(year => el('button', {
            class: 'year-button',
            onclick: () => { currentYear = year; render(); },
            style: { backgroundColor: currentYear === year ? '#2563eb' : '#e5e7eb', color: currentYear === year ? '#fff' : '#374151' }
          }, String(year)))
        ]);

        const yearGrid = el('div', { class: 'year-grid' }, [
          renderMonth(currentYear, 0),
          renderMonth(currentYear, 1),
          renderMonth(currentYear, 2),
          renderMonth(currentYear, 3),
          renderMonth(currentYear, 4),
          renderMonth(currentYear, 5),
          renderMonth(currentYear, 6),
          renderMonth(currentYear, 7),
          renderMonth(currentYear, 8),
          renderMonth(currentYear, 9),
          renderMonth(currentYear, 10),
          renderMonth(currentYear, 11)
        ]);

        const legend = el('div', { class: 'legend' }, [
          el('div', { class: 'legend-row' }, [
            el('div', { class: 'legend-swatch shift' }),
            el('span', {}, 'Vardiya Günü (3 gün)')
          ]),
          el('div', { class: 'legend-row' }, [
            el('div', { class: 'legend-swatch today' }),
            el('span', {}, 'Bugün')
          ])
        ]);

        const root = el('div', { style: { minHeight: '100vh' } }, [header, toolbar, yearGrid, legend]);
        app.appendChild(root);
      }

      render();
    </script>
  </body>
  </html>
